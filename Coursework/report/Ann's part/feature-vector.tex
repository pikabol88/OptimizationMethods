\documentclass[main.tex]{subfiles}
\begin{document}
Различают две группы методов $\Phi$ формирования вектора признаков $X'$ [1, 34]:
\begin{itemize}
    \item группа методов $\Phi_t$, основанная на использовании текстуры (значений интенсивности пикселей) изображения
    \item группа методов $\Phi_a$, основанная на выделении антропометрических точек на изображении лица человека с последующим выделением информации о расстоянии между этими точками и их взаимном расположении
\end{itemize}

\subsection{Группа методов $\Phi_t$}
К это группе относятся методы, в которых используются либо непосредственно значения интенсивности пикселей нормализованных изображений, либо результаты применения некоторых операторов к значениям интенсивностей. При этом прямое использование пикселей изображения подходит только для изображений малой размерности и на практике используется для выделения лиц на общем изображении.

Вектор признаков в таком случае представляет собой гистограмму значений интенсивносетй или их модификаций. 

\subsubsection{Метод локальных бинарных шаблонов (LBP)}
\textbf{Локальный бинарный шаблон} - определенный вид признака, представляющий собой описание окрестности пикселя изображения в двоичном представлении.

Базовый оператор LBP, применяемый к пикселю изображения, использует восемь пикселей окрестности и принимает значение интенсивности центрального пикселя в качестве порога. Пиксели, имеющие значение, большее или равное указанному, принимают значение "1", остальные - "0". Таким образом, результатом применения базового оператора LBP к пикселю изображения является восьмиразрядный бинарный код, описывающий окрестность пикселя по часовой стрелке, начиная с верхнего левого пикселя окрестности. Далее этот код рассматривается, как двоичная запись некоторого числа, сопоставленная данному пикселю.

После получения указанных значений строится их гистограмма, то есть формируется набор $\Phi_{LBP}(i)=\bar{\textbf{x}}_i=(\bar{0}_i,\bar{1}_i,...,\bar{x}_i,...,\bar{255}_i)$ частот $\bar{x}_i$ появления бинарных шаблонов, имеющих десятичные числовые эквиваленты $x,x\in\{0,1,...,255\}$ в изображении $i:\bar{x}_i\in\mathbb{R},0\leq\bar{x}_i<1$. При этом коллекция $I'$ из $m$ элементов обучающей и $k$ элементов тестовой выборок представляются матрицами размером $m\times256$ и $k\times256$:
\begin{equation}
    \Phi_{LBP}(I^l)=X^l=
        \begin{pmatrix}
            \bar{0}_1 & \bar{1}_1 & ... & \bar{x}_1 & ... & \bar{255}_1\\
            ... & ... & ... & ... & ... & ...\\
            \bar{0}_i & \bar{1}_i & ... & \bar{x}_i & ... & \bar{255}_i\\
            ... & ... & ... & ... & ... & ...\\
            \bar{0}_m & \bar{1}_m & ... & \bar{x}_m & ... & \bar{255}_m\\
        \end{pmatrix}
\end{equation}
\begin{equation}
    \Phi_{LBP}(I^t)=X^t=
        \begin{pmatrix}
            \bar{0}_1 & \bar{1}_1 & ... & \bar{x}_1 & ... & \bar{255}_1\\
            ... & ... & ... & ... & ... & ...\\
            \bar{0}_i & \bar{1}_i & ... & \bar{x}_i & ... & \bar{255}_i\\
            ... & ... & ... & ... & ... & ...\\
            \bar{0}_k & \bar{1}_k & ... & \bar{x}_k & ... & \bar{255}_k\\
        \end{pmatrix}
\end{equation}

Соответствующими векторами заменяются элементы $i$ в описаниях прецедентов $(i,y_i)$ в обучающей $\Tilde{G}^l$ и тестовой $\Tilde{G}^t$ выборках.

Локальные бинарные шаблоны характеризуют локальные особенности изображения, а частоты этих особенностей можно рассматривать как обобщенную модель лица. При этом шаблоны не характеризуют расположение данных особенностей на изображении. Для этих целей нормализованное изображение разбивается на $s$ регионов, для каждого из которых вычисляется своя гистограмма $\Phi_{LBP}(i_j)$. Тогда результирующим описанием изображения $i$ является вектор значений $\bar{x}_i$, сформированный как конкатенация $s$ гистограмм, полученных по $s$ регионам исходного изображения:
\begin{equation}
    \Phi_{LBP}(i)=\bar{\textbf{x}}_i=(\bar{0}_{i_1},\bar{1}_{i_1},...,\bar{x}_{i_1},...,\bar{255}_{i_1},...,\bar{0}_{i_j},\bar{1}_{i_j},...,\bar{x}_{i_j},...,\bar{255}_{i_j},...,\bar{0}_{i_k},\bar{1}_{i_k},...,\bar{x}_{i_s},...,\bar{255}_{i_s})
\end{equation}

Данное описание уже не является гистограммой, так как сумма значений его элементов равна $s$.

Исходя из соотношений, характерных для элементов лица человека, нормализованное изображение традиционно разбивается на $k=6\times7=42$ региона. При более крупном разбиении теряется информация о локальном расположении особенностей, а при более мелком - увеличивается размерность вектора признаков, что усложняет процесс классификации.

Не все шаблоны обладают одинаковой информативностью. Поэтому выделяют \textit{равномерные шаблоны} - бинарные комбинации, содержащие не более трех серий "0" и "1". Равномерные LBP определяют только важные локальные особенности изображения: концы линий, грани, углы и пятна. Использование только равномерных шаблонов приводит к существенному сокращению размерности вектора признаков, в этом случае используется только $p(p-1)+2$ шаблона [1, 34-39].

\subsubsection{Метод построения гистограммы направленных градиентов (HOG) и гистограмм направления края изображения (EOH)}
Метод построения гистограммы направленных градиентов (HOG) основан на вычислении градиента изменения интенсивности для каждого пикселя изображения и формировании гистограммы данных градиентов для различных участков изображения. При этом выделяются восемь базовых направлений: "север", "северо-восток" и т.д. В итоге формируется пространство признаков, близкое по своим характеристикам к методу LBP [1, 39].

Данный метод имеет свой аналог в виде метода формирования гистограмм направления края изображения EOH. Эти методы нашли основное применение при решении задач выделения заданного объекта на изображении, а не при определении атрибутов личности.

\subsection{Группа методов $\Phi_a$}
Методы данной группы основаны на воспроизведении процесса описания лица, характерном для человека: фиксируются особые точки и их расположение на лице (границы глаз, носа, рта, бровей, подбородка и т.д.)

\subsubsection{Метод активной модели формы (ASM)}
Главной предпосылкой для построения ASM является наблюдение, что между расположением антропометрических точек есть зависимости. Для моделирования этих зависимостей по обучающей выборке $\Tilde{G}^l$ строится статическая модель положения важных антропометрических точек на изображении лица. При этом в качестве признакового описания изображения используются координаты выделенных точек на нормализованных изображениях, то есть формируется набор $\Phi_{ASM}(i)=\bar{\textbf{x}}_i=(x_1,x_2,...,x_u,y_1,y_2,...,y_u)^T$, а вся совокупность из $n$ прецедентов обучающей выборки $\Tilde{G}^l$ образует матрицу $\Phi_{ASM}(\Tilde{G}^l)=X=(\bar{\textbf{x}}_1,...,\bar{\textbf{x}}_i,...,\bar{\textbf{x}}_n)$.

После выделения главных компонент указанной матрицы получаем выражение для синтезированной формы:
\begin{equation}
    \begin{array}{cc}
        X=\bar{X}+P_{sh}B_{sh}\\
        B_{sh}=P_{sh}^T(X-\bar{X})\\
    \end{array}
\end{equation}
где $\bar{X}$ - форма изображения, усредненная по всем реализациям обучающей выборки (базовая форма), $P_{sh}$ - матрица собственных векторов, $B_{sh}$ - вектор параметров формы.

Приведенное выражение означает, что форма любого изображения $X$ может быть выражена как сумма базовой формы $\bar{X}$ и линейной комбинации собственных форм, содержащихся в матрице $P_{sh}$. Меняя значение $B_{sh}$ можно синтезировать различные формы изображений [1, 40-43].

\subsubsection{Метод активной модели внешности (AAM)}
Данная модель является развитием активной модели формы (ASM), путем добавления в нее модели текстуры.

На первом этапе происходит построение активной модели формы (ASM) путем разметки нормализованного изображения лица - выделения на нем некоторых пронумерованных характерных антропометрических точек. Качественное описание изображения достигается при наличии $u=60-70$ таких точек.

Автоматическое определение важных антропометрических точек основано на выделении характерных особенностей изображения: Т-образные пересечения краев, углы, легко различимые биологические особенности, границы изображение и пр.

На втором этапе построения модели AAM учитывается информация о текстуре (значениях интенсивности пикселей) изображения. Для этого изображение разбивается на непересекающиеся треугольники, вершинами которых являются выделенные антропометрические точки активной модели формы. Далее для каждого треугольника вычисляется среднее значение интенсивности, то есть изображение описывается вектором:
\begin{equation}
    \Phi_{AAM}(i)=\bar{\textbf{z}}=(z_1,z_2,...,z_v),
\end{equation}
где $v$ - количество треугольников в изображении. А вся совокупность из $n$ прецедентов обучающей выборки $\Tilde{G}^l$ образует матрицу:
\begin{equation}
    \Phi_{AAM}(\Tilde{G}^l)=Z=(\bar{\textbf{z}}_1,\bar{\textbf{z}}_2,...,\bar{\textbf{z}}_i,...,\bar{\textbf{z}}_n)
\end{equation}

Аналогично построению активной модели формы по методу главных компонент строится приближенная модель текстуры изображения:
\begin{equation}
    \begin{array}{cc}
        Z=\bar{Z}+P_tB_t\\
        B_t=P_t^T(Z-\bar{Z})\\
    \end{array}
\end{equation}

Как и в модели формы, текстура любого изображения $Z$ может быть синтезирована суммой базовой текстуры $\bar{Z}$ и линейной комбинации собственных форм, содержащихся в матрице $P_t$. Меняя значение $B_t$ можно синтезировать различные текстуры изображений.

Общее признаковое описание изображения $i$ по методу AAM представляет собой конкатенацию векторов $\bar{x}_i$ и $\bar{z}_i$.

Метод AAM ориентирован на решение другой задачи - идентификации личности по изображению лица, так как в этом случае разметку эталонного изображения осуществляет человек, выделяя наиболее важные антропометрические точки. Построенная "вручную" модель внешности затем используется для поиска требуемой личности на других изображениях или определения выражения эмоций [1, 40-45].

\subsection{Применимость методов формирования векторов признаков}
Постановка задачи для решения методом опорных векторов удовлетворяет условиям теорем 1, 2 о разрешимости задачи квадратичного программирования.

Использование для формирования вектора признаков изображения методами группы $\Phi_t$ строят положительно определенную матрицу. Данную матрицу можно считать после небольших преобразований симметричной, так как лицо имеет достаточно симметричное строение.

При анализе применимости методов квадратичного программирования важным условием является гладкость функции цели. Данное свойство выполняется, что очевидно из постановки задачи метода опорных векторов. Дополнительно метод последовательного квадратичного программирования накладывает условие дважды дифференцируемой функции цели, что так же выполняется. А для метода последовательной минимальной оптимизации необходимо, чтобы накладываемые ограничения были линейными. Таким образом, указанные методы квадратичного программирования применимы к задачам распознавания, поставленных в указанных условиях и имеющих вектор признаков изображения, сформированный методами, основанными на использовании значений интенсивностей пикселей.

Методы из группы $\Phi_a$ не гарантируют корректное применение методов квадратичного программирования, так как при формировании вектора признаков строится матрица, не являющаяся симметричной и положительно определенной. А если приводить указанную матрицу в требуемый вид дополнительными преобразованиями, то теряется часть информации о взаимном расположении антропометрических точек.
\end{document}
